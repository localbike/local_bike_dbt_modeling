{% docs int_local_bike_data_lake__customers %}

This intermediate model enriches customer data by inferring gender based on the customer's first name.

### Purpose
The purpose of this model is to anonymize sensitive data (such as phone and email) and to enhance the dataset by adding a derived gender field. This gender is inferred through a lookup table generated by Python logic.

### Data Sources
- `stg_local_bike_data_lake__customers`: The raw staging table containing customer data.
- `stg_gender_lookups__customers_gender_lookup`: A lookup table mapping first names to inferred gender values.

### Transformations
- **Gender Enrichment**: Joins with the gender lookup table on `first_name` to add a `gender` field.
- **PII Hashing**: Applies SHA-256 hashing to personally identifiable information (`phone` and `email`) for privacy.
- **Street Normalization**: Extracts the street name from the `street` field by removing the street number.
- **Column Selection**: Selects only relevant columns for downstream use.

### Fields
- `customer_id`: Unique identifier for the customer.
- `gender`: Inferred gender based on the customer's first name.
- `phone`: SHA-256 hash of the phone number.
- `email`: SHA-256 hash of the email address.
- `street`: Street name (excluding street number).
- `city`, `state`, `zip_code`: Location details of the customer.

### Notes
- The gender inference relies on a probabilistic match via first names. As such, it may not be 100% accurate.
- This model is intended to balance data enrichment with privacy protection.

{% enddocs %}